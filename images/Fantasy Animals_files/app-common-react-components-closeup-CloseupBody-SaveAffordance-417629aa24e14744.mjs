"use strict";(self.__LOADABLE_LOADED_CHUNKS__=self.__LOADABLE_LOADED_CHUNKS__||[]).push([[53970],{243789:(e,t,a)=>{a.r(t),a.d(t,{default:()=>A});var n=a(667294),i=a(545007),r=a(883119),o=a(281584),s=a(609326),l=a(602185),c=a(989820),_=a(144326),d=a(770975);function u({constraint:e}){let t=(0,d.E)(),a=t?.getId();return(0,n.useEffect)(()=>{t&&t.markConstraintComplete(e)},[a,e]),null}var p=a(750077),m=a(864723),f=a(154785),h=a(969119),v=a(297110),g=a(897791),y=a(207462),S=a(345020),E=a(179735),I=a(785893);let k=(0,E.Z)(()=>a.e(43473).then(a.bind(a,396261)),void 0,"PinSaveButtonCommon"),b=(0,n.lazy)(async()=>({default:(await Promise.all([a.e(69965),a.e(22538)]).then(a.bind(a,474465))).QuickSaveButtonWithExperienceAnchor})),A=({boardCount:e=0,clientTrackingParams:t,fromEggsBoard:a,onBoardSelectionFlyoutChange:E,onClickCallback:A,pin:R,showEnabledSaveBehavior:C,showRepinOnInitialRender:T,variant:Z,viewParameter:w,viewType:x})=>{let P=(0,d.E)(),{experience:U}=(0,c.Ow)(1000310),{experience:D}=(0,c.Ow)(12),N=(0,f.Z)(),j=(0,i.I0)(),M=(0,_.ZP)(),O=(0,n.useRef)(!1),{pins:B,clear:L}=(0,g.Z)(),Q=(0,m.M0)().getItem(s.M8)||"",K=Q?Q===R.id:!!B&&B.length>0&&B[B.length-1].id===R.id;(0,h.Z)(()=>{O.current||2!==B.length&&(1!==B.length||K)||(O.current=!0,(2===B.length&&!Q&&K?[B[0]]:B).forEach(({id:e,nodeId:t})=>{(0,o.Z)({description:"",entityId:e,link:"",promotedIsRemovable:void 0,title:""},M).then(a=>{let{id:n,url:i,name:r}=a;j((0,y.d)({boardId:n,url:i,title:r||"",pinId:e||"",nodeId:t}))})}),K||L())});let H=()=>{(0,m.M0)().removeItem(s.M8),(0,m.M0)().removeItem(s.RD),L(),N({action:"trigger",item:"unauth-save-button-quicksave"}),j((0,S.hT)(!0)),j((0,y.d)({boardId:"",url:"",title:"Profile",pinId:R.id,nodeId:R?.node_id})),j((0,y.X)(R))},F=()=>{P&&P.markConstraintComplete("button")};if(R?.pinner?.blocked_by_me||R?.promoted_is_removable)return(0,I.jsx)(u,{constraint:"button"});if(U&&502450===U.experience_id)return(0,I.jsx)(l.Z,{name:"SafeSuspense_SaveAffordance_QuickSaveButton",children:(0,I.jsx)(p.Z,{children:(0,I.jsx)(b,{autoQuicksaveCallback:H,clientTrackingParams:t,experience:U,onClickCallback:A,onMount:F,pinKey:{type:"deprecated",data:R},shouldAutoQuicksave:K,showEnabledSaveBehavior:C,viewParameter:w})})});let G=!R.content_sensitivity?.is_sensitive_content&&void 0!==e,$=[501041],z=D&&501041===D.experience_id&&D.display_data.has_tooltip?e=>(0,I.jsx)(c.Qp,{anchor:e,experienceIds:$,idealDirection:"down",placementId:12,positionRelativeToAnchor:!0,showCaret:!0}):e=>(0,I.jsx)(c.N,{anchors:{3010:e},idealDirection:"down",onAnchorTouch:"complete",placementId:12,scrollToDismiss:!0});return G?(0,I.jsx)(r.xu,{children:(0,I.jsx)(l.Z,{name:"SafeSuspense_SaveAffordance_PinBetterSave",children:(0,I.jsx)(v.default,{autoQuicksaveCallback:H,clientTrackingParams:t,fromEggsBoard:a,onClickCallback:A,onMount:F,onToggleFlyout:E,pinKey:{type:"deprecated",data:R},renderPinSaveTooltip:z,shouldAutoQuicksave:K,variant:Z,viewParameter:w,viewType:x})})}):(0,I.jsx)(l.Z,{name:"SafeSuspense_SaveAffordance_PinSaveButton",children:(0,I.jsx)(p.Z,{children:(0,I.jsx)(k,{clientTrackingParams:t,isCloseupPin:!0,onClickCallback:A,onMount:F,pinKey:{type:"deprecated",data:R},renderPinSaveTooltip:z,showRepinOnInitialRender:T})})})}},456082:(e,t,a)=>{a.d(t,{i:()=>i,x:()=>r});var n=a(267005);let i=["shopping_rec_disabled","featureMap","comments_disabled","allow_mentions","messaging_permissions","opt_in_private_account","ads_customize_from_conversion","personalize_from_offsite_browsing","third_party_marketing_tracking_enabled","ccpa_opted_out","third_party_ads_personalization","video_rec_enabled"];function r({apiErrorCode:e,onShowMessage:t,onPassCodeRequired:a,onPassCodeSkipConfirmation:i}){e&&(({[n.RR]:t,[n.mX]:a,[n.q6]:i})[e]||t)()}},278762:(e,t,a)=>{a.d(t,{Z:()=>i});var n=a(252071);let i=e=>n.Z.create("UserPasswordResource",e).callUpdate({showError:!1})},471620:(e,t,a)=>{a.d(t,{Z:()=>n});let n=(e,t)=>e.length>t?e.substr(0,t-3).trim()+"â€¦":e},897791:(e,t,a)=>{a.d(t,{$:()=>c,Z:()=>u});var n=a(609326),i=a(192820),r=a(730212),o=a(993754),s=a(864723),l=a(166408);let c=2,_=e=>e?.pins??[],d=e=>e.length?{pins:e}:null,u=()=>{let{isAuthenticated:e,countryFromHostName:t,countryFromIp:a}=(0,r.B)(),u=(0,o.Z)({countryFromHostName:t||"",countryFromIp:a||"",isAuthenticated:e}),p=(0,s.M0)(),m=_(u?p.getItem(n.s1):l.ZP.getItem(i.w3)),f=e=>u?p.setItem(n.s1,d(e)):l.ZP.setItem(i.w3,d(e)),h=()=>m.length<c;return{pins:m,save:e=>{h()&&f(m.filter(({id:t})=>t!==e.id).concat([e]))},unsave:e=>f(m.filter(({id:t})=>t!==e)),isSaved:e=>m.some(({id:t})=>t===e),clear:()=>f([]),canSaveMore:h}}},345020:(e,t,a)=>{a.d(t,{Cp:()=>f,GT:()=>c,V6:()=>s,W2:()=>d,W6:()=>h,_L:()=>m,fm:()=>l,hT:()=>_});var n=a(252071),i=a(456082),r=a(278762),o=a(468808);function s(e,t){return{type:"UPDATE_USER_SOCIAL_NETWORK",payload:{socialNetworkName:e,connected:t}}}let l=e=>({type:"USER_DOMAIN_VERIFIED",payload:{verifiedWebsite:e}}),c=e=>({type:"USER_DOMAIN_UNVERIFIED",payload:{verifiedWebsite:e}});function _(e){return{type:"UPDATE_HAS_QUICKSAVE_BOARD",payload:{createdQuicksaveBoard:e}}}let d=(e,t,a)=>n=>{n({type:"USER_SETTING_CHANGE",payload:{id:e,field:t,value:a}})},u=(e,t,a)=>n=>{n({type:"USER_PARTNER_SETTING_CHANGE",payload:{id:e,field:t,value:a}})},p=e=>{let t=e.split(" ");return{first_name:t[0],last_name:t[1]}},m=({field:e,value:t,passcode:a,onSettingSavedHn:r,showErrorHn:s,surfaceTag:l,userId:c,passcodeSkipAcknowledged:_=!1,otp:m,onFinallyHn:f})=>async(h,v)=>{let g=v().users[c],y={user_id:c,surface_tag:l};if("full_name"===e){if(g.is_partner)y.business_name=t;else{let e=p(t);y.first_name=e.first_name,y.last_name=e.last_name||""}}else y[e]=t;a&&(y.passcode=a),i.i.includes(e)&&null!=_&&(y.user_confirm_skip_passcode=_),m&&(y.otp=m);try{let a=await n.Z.create("UserSettingsResource",y).callUpdate();if("email"===e&&a?.resource_response.data?.email_changing_to){s({email_changing_to:a.resource_response.data.email_changing_to});return}if("profile_image_url"===e)h((0,o.b)("UserResource",{options:y}));else if("full_name"===e){if(g.is_partner)h(d(c,"first_name",t));else{let e=p(t);h(d(c,"first_name",e.first_name)),h(d(c,"last_name",e.last_name))}}h(g.is_partner&&("account_type"===e||"contact_name"===e)?u(c,e,t):d(c,e,t)),r()}catch(e){s(e)}finally{f?.()}},f=(e,t,a,n,i,o,s)=>()=>{(0,r.Z)({new:t,new_confirm:a,old:e,passcode:n,recaptcha_v3_token:i}).then(o,s)},h=(e,t,a,i,r,o)=>s=>{s(d(e,`${t}.${a}`,i));let l={},c="EmailSettingsResource";void 0!==r?(l={section:t,option:a,value:i,od:r.od,user_id:r.user_id},c="UnsubEmailSettingsResource"):l={section:t,option:a,value:i},n.Z.create(c,l).callUpdate().then(o).catch(()=>s(d(e,`${t}.${a}`,!i)))}}}]);
//# sourceMappingURL=https://sm.pinimg.com/webapp/app-common-react-components-closeup-CloseupBody-SaveAffordance-417629aa24e14744.mjs.map